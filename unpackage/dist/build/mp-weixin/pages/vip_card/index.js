(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/vip_card/index"],{"1e9d":function(t,e,i){"use strict";(function(t){var n=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i("218c"),s=i("7220"),o=(i("a612"),i("6188"),i("23b4")),r=i("26cb"),u=n(i("6a7c")),d={components:{couponListWindow:function(){Promise.all([i.e("common/vendor"),i.e("components/couponListWindow/index")]).then(function(){return resolve(i("fe72"))}.bind(null,i)).catch(i.oe)},addressWindow:function(){i.e("components/addressWindow/index").then(function(){return resolve(i("9f59"))}.bind(null,i)).catch(i.oe)},orderGoods:function(){Promise.all([i.e("common/vendor"),i.e("components/orderGoods/index")]).then(function(){return resolve(i("9f23"))}.bind(null,i)).catch(i.oe)},home:function(){Promise.all([i.e("common/vendor"),i.e("components/home/index")]).then(function(){return resolve(i("47cf"))}.bind(null,i)).catch(i.oe)},authorize:function(){i.e("components/Authorize").then(function(){return resolve(i("1fc0"))}.bind(null,i)).catch(i.oe)}},mixins:[u.default],data:function(){return{confirm:[],textareaStatus:!0,cartArr:[{name:"微信支付",icon:"icon-weixin2",value:"weixin",title:"使用微信快捷支付",payStatus:1},{name:"支付宝支付",icon:"icon-zhifubao",value:"alipay",title:"使用线上支付宝支付",payStatus:1},{name:"余额支付",icon:"icon-yuezhifu",value:"yue",title:"可用余额:",payStatus:1},{name:"线下支付",icon:"icon-yuezhifu1",value:"offline",title:"选择线下付款方式",payStatus:2}],formContent:"",payType:"weixin",openType:1,active:0,coupon:{coupon:!1,list:[],statusTile:"立即使用"},address:{address:!1},addressInfo:{},pinkId:0,addressId:0,couponId:0,cartId:"",BargainId:0,combinationId:0,seckillId:0,userInfo:{},mark:"",couponTitle:"请选择",coupon_price:0,useIntegral:!1,integral_price:0,integral:0,ChangePrice:0,formIds:[],status:0,is_address:!1,toPay:!1,shippingType:0,system_store:{},storePostage:0,contacts:"",contactsTel:"",mydata:{},storeList:[],store_self_mention:0,cartInfo:{},priceGroup:{},animated:!1,totalPrice:0,integralRatio:"0",pagesUrl:"",orderKey:"",offlinePostage:"",isAuto:!1,isShowAuth:!1,from:"",news:1,invTitle:"不开发票",special_invoice:!1,invoice_func:!1,header_type:"",invShow:!1,invList:[],invChecked:"",urlQuery:"",pay_close:!1,resData:{},product_type:1,newImg:[]}},computed:(0,r.mapGetters)(["isLogin"]),onLoad:function(t){if(this.from="routine",!t.unique)return this.$util.Tips({title:"请选择要购买的商品"},{tab:3,url:1});this.unique=t.unique,this.num=t.num,this.couponId=t.couponId||0,this.pinkId=t.pinkId?parseInt(t.pinkId):0,this.addressId=t.addressId||0,this.cartId=t.cartId,this.is_address=!!t.is_address,this.news=t.new&&"0"!==t.new?1:0,this.invChecked=t.invoice_id||"",this.header_type=t.header_type||"1",this.couponTitle=t.couponTitle||"请选择",this.textareaStatus=!0,this.isLogin&&0==this.toPay?(this.getaddressInfo(),this.getConfirm(),this.$nextTick((function(){this.$refs.addressWindow.getAddressList()}))):(0,o.toLogin)()},onShow:function(){var e=this;t.$on("handClick",(function(i){i&&(e.system_store=i.address),t.$off("handClick")}))},methods:{jumpCon:function(e){t.navigateTo({url:"/pages/goods_details/index?id=".concat(e)})},DelPic:function(t,e){this.confirm[t].value;this.confirm[t].value.splice(e,1),this.$set(this.confirm[t],"value",this.confirm[t].value)},uploadpic:function(t){var e=this;this.$util.uploadImageOne("upload/image",(function(i){e.newImg.push(i.data.url),e.$set(e.confirm[t],"value",e.newImg)}))},getInvoiceList:function(){var e=this;t.showLoading({title:"正在加载…"}),(0,s.invoiceList)().then((function(i){t.hideLoading(),e.invList=i.data.map((function(t){return t.id=t.id.toString(),t}));var n=e.invList.find((function(t){return t.id==e.invChecked}));if(n){var a="";a+=1===n.header_type?"个人":"企业",a+=1===n.type?"普通":"专用",a+="发票",e.invTitle=a}})).catch((function(e){t.showToast({title:e,icon:"none"})}))},onChangeFun:function(t){var e=t,i=e.action||null,n=void 0!=e.value?e.value:null;i&&this[i]&&this[i](n)},payClose:function(){this.pay_close=!1},goPay:function(){var e=this;if(!e.addressId&&!e.product_type)return e.$util.Tips({title:"请选择收货地址"});for(var i=0;i<e.confirm.length;i++){var n=e.confirm[i];if(n.status){if(("text"===n.label||"data"===n.label||"time"===n.label)&&!n.value.trim())return e.$util.Tips({title:"请填写".concat(n.title)});if("number"===n.label&&n.value<=0)return e.$util.Tips({title:"请填写".concat(n.title)});if("email"===n.label&&!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(n.value))return e.$util.Tips({title:"请填写正确的".concat(n.title)});if("phone"===n.label&&!/^1(3|4|5|7|8|9|6)\d{9}$/i.test(n.value))return e.$util.Tips({title:"请填写正确的".concat(n.title)});if("id"===n.label&&!/^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$|^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/i.test(n.value))return e.$util.Tips({title:"请填写正确的".concat(n.title)});if("img"===n.label&&!n.value.length)return e.$util.Tips({title:"请上传".concat(n.title)})}}var s={custom_form:e.confirm,addressId:e.addressId,mark:e.mark,unique:this.cartInfo.unique,num:this.resData.num};(0,a.vipcardOrderCreate)(s).then((function(e){t.redirectTo({url:"/pages/points_mall/integral_order_status?order_id=".concat(e.data.result.orderId)})})).catch((function(i){return t.hideLoading(),e.$util.Tips({title:i})}))},changeClose:function(){this.$set(this.address,"address",!1)},computedPrice:function(){var t=this,e=this.shippingType;postOrderComputed(this.orderKey,{addressId:this.addressId,useIntegral:this.useIntegral?1:0,couponId:this.couponId,shipping_type:parseInt(e)+1,payType:this.payType}).then((function(i){var n=i.data.result;n&&(t.totalPrice=n.pay_price,t.integral_price=n.deduction_price,t.coupon_price=n.coupon_price,t.integral=t.useIntegral?n.SurplusIntegral:t.userInfo.integral,t.$set(t.priceGroup,"storePostage",1==e?0:n.pay_postage),t.$set(t.priceGroup,"storePostageDiscount",n.storePostageDiscount))}))},ChangCouponsClone:function(){this.$set(this.coupon,"coupon",!1)},changeTextareaStatus:function(){for(var t=0,e=this.coupon.list.length;t<e;t++)this.coupon.list[t].use_title="",this.coupon.list[t].is_use=0;this.textareaStatus=!0,this.status=0,this.$set(this.coupon,"list",this.coupon.list)},OnChangeAddress:function(t){this.textareaStatus=!0,this.addressId=t,this.address.address=!1,this.getaddressInfo()},bindHideKeyboard:function(t){this.mark=t.detail.value},getConfirm:function(){var t=this,e=this;(0,a.vipcardOrderConfirm)({unique:this.unique,num:this.num}).then((function(t){e.$set(e,"confirm",t.data.custom_form),e.$set(e,"product_type",parseInt(t.data.productInfo.product_type)),e.$set(e,"resData",t.data),e.$set(e,"cartInfo",t.data.productInfo)})).catch((function(e){return t.$util.Tips({title:e})}))},bindDateChange:function(t,e){this.confirm[e].value=t.target.value},bindTimeChange:function(t,e){this.confirm[e].value=t.target.value},getBargainId:function(){var t=this.cartInfo,e=0,i=0;t.forEach((function(t,n,a){e=a[n].bargain_id,i=a[n].combination_id})),this.$set(this,"BargainId",parseInt(e)),this.$set(this,"combinationId",parseInt(i)),3==this.cartArr.length&&(e||i||this.seckillId)&&(this.cartArr[2].payStatus=0,this.$set(this,"cartArr",this.cartArr))},getaddressInfo:function(){var t=this;t.addressId?(0,s.getAddressDetail)(t.addressId).then((function(e){e.data.is_default=parseInt(e.data.is_default),t.addressInfo=e.data||{},t.addressId=e.data.id||0,t.address.addressId=e.data.id||0})):(0,s.getAddressDefault)().then((function(e){e.data.is_default=parseInt(e.data.is_default),t.addressInfo=e.data||{},t.addressId=e.data.id||0,t.address.addressId=e.data.id||0}))},couponTap:function(){var t=this;this.coupon.coupon=!0,this.coupon.list.forEach((function(e,i){e.id==t.couponId?e.is_use=1:e.is_use=0})),this.$set(this.coupon,"list",this.coupon.list)},car:function(){this.animated=!1},onAddress:function(){this.textareaStatus=!1,this.address.address=!0,this.pagesUrl="/pages/points_mall/user_address?unique=".concat(this.unique,"&num=").concat(this.num)},clickTextArea:function(){var t=this;this.$nextTick((function(){t.$refs.getFocus.focus()}))}}};e.default=d}).call(this,i("543d")["default"])},3528:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,i=(t._self._c,t.confirm.length),n=i?t.__map(t.confirm,(function(e,i){var n=t.__get_orig(e),a="img"==e.label?e.value.length:null;return{$orig:n,g1:a}})):null;t.$mp.data=Object.assign({},{$root:{g0:i,l0:n}})},a=[]},5695:function(t,e,i){"use strict";var n=i("754b"),a=i.n(n);a.a},"5fa8":function(t,e,i){"use strict";i.r(e);var n=i("3528"),a=i("9341");for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(s);i("5695");var o=i("f0c5"),r=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"55092388",null,!1,n["a"],void 0);e["default"]=r.exports},"754b":function(t,e,i){},9341:function(t,e,i){"use strict";i.r(e);var n=i("1e9d"),a=i.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=a.a},a90d:function(t,e,i){"use strict";(function(t,e){var n=i("4ea4");i("98d3");n(i("66fd"));var a=n(i("5fa8"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(a.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])}},[["a90d","common/runtime","common/vendor"]]]);