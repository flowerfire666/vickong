(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/points_mall/integral_goods_details"],{2831:function(t,e,i){"use strict";var s=i("455d"),r=i.n(s);r.a},"31c7":function(t,e,i){"use strict";(function(t,e){var s=i("4ea4");i("98d3");s(i("66fd"));var r=s(i("f135"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(r.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},"3bde":function(t,e,i){"use strict";i.r(e);var s=i("929d"),r=i.n(s);for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);e["default"]=r.a},"455d":function(t,e,i){},"929d":function(t,e,i){"use strict";(function(t){var s=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,o=s(i("9523")),a=i("26cb"),u=i("218c"),n=(i("771e"),i("23b4")),c=i("a7fa"),h=(i("7220"),s(i("6a7c"))),l=getApp(),d=(r={computed:(0,a.mapGetters)(["isLogin"]),mixins:[h.default],data:function(){return{dataShow:0,id:0,time:0,countDownHour:"00",countDownMinute:"00",countDownSecond:"00",storeInfo:[],imgUrls:[],parameter:{navbar:"1",return:"1",title:"抢购详情页",color:!1},attribute:{cartAttr:!1,productAttr:[],productSelect:{}},productValue:[],isOpen:!1,attr:"请选择",attrValue:"",status:1,isAuto:!1,isShowAuth:!1,iShidden:!1,limitNum:1,iSplus:!1,replyCount:0,reply:[],replyChance:0,navH:"",navList:["商品","详情"],opacity:0,scrollY:0,topArr:[],toView:"",height:0,heightArr:[],lock:!1,scrollTop:0,tagStyle:{img:"width:100%;display:block;",table:"width:100%",video:"width:100%"},datatime:"",navActive:0,meunHeight:0,backH:"",posters:!1,weixinStatus:!1,posterImageStatus:!1,storeImage:"",PromotionCode:"",posterImage:"",actionSheetHidden:!1,cart_num:1,homeTop:20,returnShow:!0,H5ShareBox:!1,routineContact:0}},components:{productConSwiper:function(){i.e("components/productConSwiper/index").then(function(){return resolve(i("6a26"))}.bind(null,i)).catch(i.oe)},productWindow:function(){i.e("pages/points_mall/component/productWindow").then(function(){return resolve(i("383e"))}.bind(null,i)).catch(i.oe)},userEvaluation:function(){Promise.all([i.e("common/vendor"),i.e("components/userEvaluation/index")]).then(function(){return resolve(i("5580"))}.bind(null,i)).catch(i.oe)},kefuIcon:function(){Promise.all([i.e("common/vendor"),i.e("components/kefuIcon/index")]).then(function(){return resolve(i("cb40"))}.bind(null,i)).catch(i.oe)},"jyf-parser":function(){Promise.all([i.e("common/vendor"),i.e("components/mp-html/mp-html")]).then(function(){return resolve(i("4a75"))}.bind(null,i)).catch(i.oe)},countDown:function(){i.e("components/countDown/index").then(function(){return resolve(i("510f"))}.bind(null,i)).catch(i.oe)},authorize:function(){i.e("components/Authorize").then(function(){return resolve(i("1fc0"))}.bind(null,i)).catch(i.oe)}}},(0,o.default)(r,"computed",(0,a.mapGetters)(["isLogin"])),(0,o.default)(r,"watch",{isLogin:{handler:function(t,e){t&&this.getIntegralProductDetail()},deep:!0}}),(0,o.default)(r,"onLoad",(function(e){var i=this,s=this,r=getCurrentPages();s.returnShow=1!==r.length,t.getSystemInfo({success:function(t){s.height=t.windowHeight,t.statusBarHeight}}),this.isLogin&&(0,c.silenceBindingSpread)(),this.navH=l.globalData.navHeight;var o=t.getMenuButtonBoundingClientRect();if(this.meunHeight=o.height,this.backH=s.navH/2+this.meunHeight/2,e.scene){var a=this.$util.getUrlParams(decodeURIComponent(e.scene));if(!a.id)return this.$util.Tips({title:"缺少参数无法查看商品"},{tab:3,url:1});this.id=a.id,a.pid&&(l.globalData.spid=a.pid),a.time&&(this.datatime=a.time)}e.id&&(this.id=e.id,this.datatime=Number(e.time),this.status=e.status),this.isLogin?this.getIntegralProductDetail():(0,n.toLogin)(),this.$nextTick((function(){var e=t.getMenuButtonBoundingClientRect(),s=t.createSelectorQuery().in(i);s.select("#home").boundingClientRect((function(t){i.homeTop=2*e.top+e.height-t.height})).exec()}))})),(0,o.default)(r,"methods",{iptCartNum:function(t){this.$set(this.attribute.productSelect,"cart_num",t),this.$set(this,"cart_num",t)},returns:function(){t.navigateBack()},onLoadFun:function(t){this.isAuto&&(this.isAuto=!1,this.isShowAuth=!1,this.getIntegralProductDetail())},getIntegralProductDetail:function(){var e=this,i=this;(0,u.getIntegralProductDetail)(i.id).then((function(s){e.dataShow=1;var r=s.data.storeInfo.title;e.storeInfo=s.data.storeInfo,e.imgUrls=s.data.storeInfo.images,e.storeInfo.description=e.storeInfo.description.replace(/<img/gi,'<img style="max-width:100%;height:auto;float:left;display:block" '),e.attribute.productAttr=s.data.productAttr,e.productValue=s.data.productValue,e.attribute.productSelect.num=s.data.storeInfo.num,e.replyCount=s.data.replyCount,e.reply=s.data.reply?[s.data.reply]:[],e.replyChance=s.data.replyChance,i.routineContact=s.data.routine_contact_type,t.setNavigationBarTitle({title:r.substring(0,7)+"..."}),i.DefaultSelect(),l.globalData.openPages="/pages/activity/goods_seckill_details/index?id="+i.id+"&time="+i.time+"&status="+i.status+"&scene="+i.storeInfo.uid})).catch((function(t){i.$util.Tips({title:t},{tab:3})}))},setShare:function(){this.$wechat.isWeixin()&&this.$wechat.wechatEvevt(["updateAppMessageShareData","updateTimelineShareData","onMenuShareAppMessage","onMenuShareTimeline"],{desc:this.storeInfo.info,title:this.storeInfo.title,link:location.href,imgUrl:this.storeInfo.image}).then((function(t){})).catch((function(t){}))},DefaultSelect:function(){var t=this.attribute.productAttr,e=[];for(var i in this.productValue)if(this.productValue[i].quota>0){e=this.attribute.productAttr.length?i.split(","):[];break}for(var s=0;s<t.length;s++)this.$set(t[s],"index",e[s]);var r=this.productValue[e.join(",")];r&&t.length?(this.$set(this.attribute.productSelect,"store_name",this.storeInfo.title),this.$set(this.attribute.productSelect,"image",r.image),this.$set(this.attribute.productSelect,"price",r.price),this.$set(this.attribute.productSelect,"stock",r.stock),this.$set(this.attribute.productSelect,"unique",r.unique),this.$set(this.attribute.productSelect,"quota",r.quota),this.$set(this.attribute.productSelect,"quota_show",r.quota_show),this.$set(this.attribute.productSelect,"product_stock",r.product_stock),this.$set(this.attribute.productSelect,"cart_num",1),this.$set(this,"attrValue",e.join(",")),this.attrValue=e.join(",")):!r&&t.length?(this.$set(this.attribute.productSelect,"store_name",this.storeInfo.title),this.$set(this.attribute.productSelect,"image",this.storeInfo.image),this.$set(this.attribute.productSelect,"price",this.storeInfo.price),this.$set(this.attribute.productSelect,"quota",0),this.$set(this.attribute.productSelect,"quota_show",0),this.$set(this.attribute.productSelect,"product_stock",0),this.$set(this.attribute.productSelect,"stock",0),this.$set(this.attribute.productSelect,"unique",""),this.$set(this.attribute.productSelect,"cart_num",0),this.$set(this,"attrValue",""),this.$set(this,"attrTxt","请选择")):r||t.length||(this.$set(this.attribute.productSelect,"store_name",this.storeInfo.title),this.$set(this.attribute.productSelect,"image",this.storeInfo.image),this.$set(this.attribute.productSelect,"price",this.storeInfo.price),this.$set(this.attribute.productSelect,"stock",this.storeInfo.stock),this.$set(this.attribute.productSelect,"quota",this.storeInfo.quota),this.$set(this.attribute.productSelect,"product_stock",this.storeInfo.product_stock),this.$set(this.attribute.productSelect,"unique",this.storeInfo.unique||""),this.$set(this.attribute.productSelect,"cart_num",1),this.$set(this.attribute.productSelect,"quota",r.quota),this.$set(this.attribute.productSelect,"product_stock",r.product_stock),this.$set(this,"attrValue",""),this.$set(this,"attrTxt","请选择"))},selecAttr:function(){this.attribute.cartAttr=!0},onMyEvent:function(){this.$set(this.attribute,"cartAttr",!1),this.$set(this,"isOpen",!1)},ChangeCartNum:function(t){var e=this.productValue[this.attrValue];if(this.cart_num&&(e.cart_num=this.cart_num,this.attribute.productSelect.cart_num=this.cart_num),void 0!==e||this.attribute.productAttr.length||(e=this.attribute.productSelect),void 0!==e){e.stock,e.quota_show,e.quota,e.product_stock;var i=this.attribute.productSelect;this.storeInfo.num;if(void 0==e.cart_num&&(e.cart_num=1),t)i.cart_num<this.attribute.productSelect.quota&&(i.cart_num++,this.$set(this.attribute.productSelect,"cart_num",i.cart_num),this.$set(this,"cart_num",i.cart_num),this.$set(this.attribute.productSelect,"cart_num",i.cart_num));else{if(1==i.cart_num)return;i.cart_num--,this.$set(this,"cart_num",i.cart_num),this.$set(this.attribute.productSelect,"cart_num",i.cart_num)}}},attrVal:function(t){this.attribute.productAttr[t.indexw].index=this.attribute.productAttr[t.indexw].attr_values[t.indexn]},ChangeAttr:function(t){this.$set(this,"cart_num",1);var e=this.productValue[t];e?(this.$set(this.attribute.productSelect,"image",e.image),this.$set(this.attribute.productSelect,"price",e.price),this.$set(this.attribute.productSelect,"stock",e.stock),this.$set(this.attribute.productSelect,"unique",e.unique),this.$set(this.attribute.productSelect,"cart_num",1),this.$set(this.attribute.productSelect,"quota",e.quota),this.$set(this.attribute.productSelect,"quota_show",e.quota_show),this.$set(this,"attrValue",t),this.attrTxt="已选择"):(this.$set(this.attribute.productSelect,"image",this.storeInfo.image),this.$set(this.attribute.productSelect,"price",this.storeInfo.price),this.$set(this.attribute.productSelect,"stock",0),this.$set(this.attribute.productSelect,"unique",""),this.$set(this.attribute.productSelect,"cart_num",0),this.$set(this.attribute.productSelect,"quota",0),this.$set(this.attribute.productSelect,"quota_show",0),this.$set(this,"attrValue",""),this.attrTxt="已选择")},scroll:function(t){var e=t.detail.scrollTop,i=e/200;if(i=i>1?1:i,this.opacity=i,this.scrollY=e,this.lock)this.lock=!1;else for(var s=0;s<this.topArr.length;s++)if(e<this.topArr[s]-l.globalData.navHeight/2+this.heightArr[s]){this.navActive=s;break}},tap:function(t,e){var i=t.id;e=e;this.toView=i,this.navActive=e,this.lock=!0,this.scrollTop=e>0?this.topArr[e]-l.globalData.navHeight/2:this.topArr[e]},goCat:function(){var e=this.productValue[this.attrValue];return this.isOpen?this.attribute.cartAttr=!0:this.attribute.cartAttr=!this.attribute.cartAttr,!0===this.attribute.cartAttr&&0==this.isOpen?this.isOpen=!0:this.attribute.productAttr.length&&void 0===e&&1==this.isOpen?l.$util.Tips({title:"请选择属性"}):this.cart_num<=0?l.$util.Tips({title:"请选择数量"}):(this.isOpen=!1,void t.navigateTo({url:"/pages/points_mall/integral_order?unique=".concat(e.unique,"&num=").concat(this.cart_num||1)}))}}),r);e.default=d}).call(this,i("543d")["default"])},b21b:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){}));var s=function(){var t=this.$createElement,e=(this._self._c,this.attribute.productAttr.length);this.$mp.data=Object.assign({},{$root:{g0:e}})},r=[]},f135:function(t,e,i){"use strict";i.r(e);var s=i("b21b"),r=i("3bde");for(var o in r)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return r[t]}))}(o);i("2831");var a=i("f0c5"),u=Object(a["a"])(r["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],void 0);e["default"]=u.exports}},[["31c7","common/runtime","common/vendor"]]]);