(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/Authorize"],{"0204":function(t,e,n){"use strict";var o=n("3971"),a=n.n(o);a.a},"1fc0":function(t,e,n){"use strict";n.r(e);var o=n("937a"),a=n("3e37");for(var i in a)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(i);n("0204");var u=n("f0c5"),s=Object(u["a"])(a["default"],o["b"],o["c"],!1,null,"03cc894a",null,!1,o["a"],void 0);e["default"]=s.exports},3971:function(t,e,n){},"3e37":function(t,e,n){"use strict";n.r(e);var o=n("cc9b"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=a.a},"937a":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){}));var o=function(){var t=this.$createElement;this._self._c},a=[]},cc9b:function(t,e,n){"use strict";(function(t,o){var a=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("249b")),u=n("771e"),s=n("6188"),c=n("26cb"),d=a(n("5602")),r=a(n("0eea")),l=getApp(),f={name:"Authorize",props:{isAuto:{type:Boolean,default:!0},isGoIndex:{type:Boolean,default:!0},isShowAuth:{type:Boolean,default:!1}},data:function(){return{logoUrl:"",authKey:""}},computed:(0,c.mapGetters)(["isLogin","userInfo"]),watch:{isLogin:function(t){!0===t&&this.$emit("onLoadFun",this.userInfo)}},mounted:function(){this.getLogoUrl();var e=this;this.isLogin||i.default.has(s.STATE_R_KEY)?this.setAuthStatus():t.login({success:function(t){i.default.set(s.STATE_R_KEY,t.code,10800);var n=l.globalData.spid?l.globalData.spid:"";(0,u.silenceAuth)({code:t.code,spread:n,spid:l.globalData.code}).then((function(t){if(void 0!==t.data.key&&t.data.key)e.authKey=t.data.key;else{l.globalData.code=0;var n=t.data.expires_time-i.default.time();r.default.commit("LOGIN",{token:t.data.token,time:n})}})).catch((function(t){}))}})},methods:{setAuthStatus:function(){var t=this;d.default.authorize().then((function(e){!1===e.islogin?t.setUserInfo():t.$emit("onLoadFun",t.userInfo)})).catch((function(e){t.isAuto&&t.$emit("authColse",!0)}))},getUserInfo:function(t){var e=this;d.default.getUserInfo().then((function(n){var a=n.userInfo;a.code=t,a.spread_spid=l.globalData.spid,a.spread_code=l.globalData.code,d.default.authUserInfo(a).then((function(t){o.hideLoading(),e.$emit("authColse",!1),e.$emit("onLoadFun",e.userInfo)})).catch((function(t){o.hideLoading(),o.showToast({title:t.msg,icon:"none",duration:2e3})}))})).catch((function(t){o.hideLoading()}))},getUserPhoneNumber:function(t,e,n){var a=this;(0,u.getUserPhone)({encryptedData:t,iv:e,code:n,spid:l.globalData.spid,spread:l.globalData.code}).then((function(t){var e=t.data.expires_time-a.$Cache.time();a.$store.commit("LOGIN",{token:t.data.token,time:e}),a.$emit("authColse",!1),a.$emit("onLoadFun",t.data.userInfo),o.hideLoading()})).catch((function(t){o.hideLoading()}))},setUserInfo:function(t){var e=this;o.showLoading({title:"正在登录中"}),d.default.getCode().then((function(n){e.getUserPhoneNumber(t.detail.encryptedData,t.detail.iv,n)})).catch((function(t){o.hideLoading()}))},getLogoUrl:function(){var t=this;i.default.has(s.LOGO_URL)?this.logoUrl=i.default.get(s.LOGO_URL):(0,u.getLogo)().then((function(e){t.logoUrl=e.data.logo_url,i.default.set(s.LOGO_URL,t.logoUrl)}))},close:function(){var t=getCurrentPages();t[t.length-1];this.isGoIndex?o.navigateTo({url:"/pages/index/index"}):this.$emit("authColse",!1)}}};e.default=f}).call(this,n("bc2e")["default"],n("543d")["default"])}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/Authorize-create-component',
    {
        'components/Authorize-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("1fc0"))
        })
    },
    [['components/Authorize-create-component']]
]);
